<?php require_once $path.'authentication.php'; ?>
<!DOCTYPE html>
<html lang="en" data-textdirection="ltr" class="loading">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=0, minimal-ui">
    <meta name="description" content="Robust admin is super flexible, powerful, clean &amp; modern responsive bootstrap 4 admin template with unlimited possibilities.">
    <meta name="keywords" content="admin template, robust admin template, dashboard template, flat admin template, responsive admin template, web app">
    <meta name="author" content="PIXINVENT">
    <title>Document Tracking System</title>
    <link rel="shortcut icon" type="image/x-icon" href="<?=$url?>images/ico/itrack-icon.png">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-touch-fullscreen" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="default">
    <!-- BEGIN VENDOR CSS-->
    <link rel="stylesheet" type="text/css" href="<?=$url?>app-assets/css/bootstrap.css">
    <!-- font icons-->
    <link rel="stylesheet" type="text/css" href="<?=$url?>app-assets/fonts/icomoon.css">
    <link rel="stylesheet" type="text/css" href="<?=$url?>app-assets/fonts/flag-icon-css/css/flag-icon.min.css">
    <link rel="stylesheet" type="text/css" href="<?=$url?>app-assets/vendors/css/extensions/pace.css">
    <!-- END VENDOR CSS-->
    <!-- BEGIN ROBUST CSS-->
    <link rel="stylesheet" type="text/css" href="<?=$url?>app-assets/css/bootstrap-extended.css">
    <link rel="stylesheet" type="text/css" href="<?=$url?>app-assets/css/app.css">
    <link rel="stylesheet" type="text/css" href="<?=$url?>app-assets/css/colors.css">
    <link rel="stylesheet" type="text/css" href="<?=$url?>app-assets/css/switch.css">
    <link rel="stylesheet" type="text/css" href="<?=$url?>app-assets/css/switch-sm.css">
    <!-- END ROBUST CSS-->
    <!-- BEGIN Page Level CSS-->
    <link rel="stylesheet" type="text/css" href="<?=$url?>app-assets/css/core/menu/menu-types/vertical-menu.css">
    <link rel="stylesheet" type="text/css" href="<?=$url?>app-assets/css/core/menu/menu-types/vertical-overlay-menu.css">
    <link rel="stylesheet" type="text/css" href="<?=$url?>app-assets/css/core/colors/palette-gradient.css">
    <!-- END Page Level CSS-->
    <!-- BEGIN Custom CSS-->
    <link rel="stylesheet" type="text/css" href="<?=$url?>assets/css/style.css">
    <link rel="stylesheet" type="text/css" href="<?=$url?>assets/css/files.css">
    <!-- END Custom CSS-->
	<style type="text/css">
	
		.revision-files {
		
			margin-bottom: 5px;
		
		}
		
		.table-revisions {
		
			font-size: 12px;
		
		}
	
	</style>
  </head>
  <body ng-app="action" ng-controller="actionCtrl" data-open="click" data-menu="vertical-menu" data-col="2-columns" class="vertical-layout vertical-menu 2-columns fixed-navbar" account-profile listen-barcode>

    <!-- navbar-fixed-top-->
    <nav class="header-navbar navbar navbar-with-menu navbar-fixed-top navbar-semi-dark navbar-shadow">
      <div class="navbar-wrapper">
        <div class="navbar-header">
          <ul class="nav navbar-nav">
            <li class="nav-item mobile-menu hidden-md-up float-xs-left"><a class="nav-link nav-menu-main menu-toggle hidden-xs"><i class="icon-menu5 font-large-1"></i></a></li>
            <li class="nav-item"><a href="index.html" class="navbar-brand nav-link"><img alt="branding logo" src="<?=$url?>images/logo/itrack-logo-large.png" data-expand="<?=$url?>images/logo/itrack-logo-large.png" data-collapse="<?=$url?>images/logo/itrack-logo-small.png" class="brand-logo"></a></li>
            <li class="nav-item hidden-md-up float-xs-right"><a data-toggle="collapse" data-target="#navbar-mobile" class="nav-link open-navbar-container"><i class="icon-ellipsis pe-2x icon-icon-rotate-right-right"></i></a></li>
          </ul>
        </div>
        <div class="navbar-container content container-fluid">
          <div id="navbar-mobile" class="collapse navbar-toggleable-sm">
            <ul class="nav navbar-nav">
              <li class="nav-item hidden-sm-down"><a class="nav-link nav-menu-main menu-toggle hidden-xs"><i class="icon-menu5"></i></a></li>
              <li class="nav-item hidden-sm-down"><a href="#" class="nav-link nav-link-expand"><i class="ficon icon-expand2"></i></a></li>
            </ul>
            <ul class="nav navbar-nav float-xs-right">
			  <?php require_once 'notifications.php'; ?>
              <li class="dropdown dropdown-user nav-item"><a href="#" data-toggle="dropdown" class="dropdown-toggle nav-link dropdown-user-link"><span class="avatar avatar-online"><img src="<?=$url?>{{profile.picture}}" alt="avatar"><i></i></span><span class="user-name">{{profile.user}}</span></a>
                <div class="dropdown-menu dropdown-menu-right" drop-down></div>
              </li>
            </ul>
          </div>
        </div>
      </div>
    </nav>

    <!-- ////////////////////////////////////////////////////////////////////////////-->


    <!-- main menu-->
    <div data-scroll-to-active="true" class="main-menu menu-fixed menu-dark menu-accordion menu-shadow">
      <!-- main menu header-->
      <div class="main-menu-header">
        <!-- <input type="text" placeholder="Search" class="menu-search form-control round"/> -->
      </div>
      <!-- / main menu header-->
      <!-- main menu content-->
      <div class="main-menu-content">
		<?php require_once 'main-menu-navigation.php'; ?>
      </div>
      <!-- /main menu content-->
      <!-- main menu footer-->
      <!-- include includes/menu-footer-->
      <!-- main menu footer-->
    </div>
    <!-- / main menu-->
    <div class="app-content content container-fluid">
	<?php // var_dump($document); ?>
      <div class="content-wrapper">
        <div class="content-header row">
			<div class="content-header-left col-md-6 col-xs-12 mb-1">
				<h2 class="content-header-title">Update Document Tracks</h2>
			</div>
			<div class="content-header-right breadcrumbs-right breadcrumbs-top col-lg-6">
				<div class="breadcrumb-wrapper col-xs-12">
				  <ol class="breadcrumb">
					<li class="breadcrumb-item"><a href="../../index.html" class="info">iTrack</a></li>
					<li class="breadcrumb-item active"><a href="../../update-tracks.html" class="info">Update Tracks</a></li>
					<li class="breadcrumb-item active">Document</li>
				  </ol>
				</div>
			</div>
        </div>		
        <div class="content-body">
			<div class="row">
				<div class="col-xs-12 mt-1 mb-3">
					<!-- <h4></h4> -->
					<hr>
				</div>
			</div>
			<div class="row">
				<div class="col-lg-8">
					<section class="card">
						<div class="card-header">
							<h4 class="card-title" id="basic-layout-form">Primary Info</h4>
						</div>
						<div class="card-body collapse in" aria-expanded="true">
							<div class="card-block">
								<div class="row">
									<div class="col-md-6 col-sm-12 text-xs-center text-md-left">
										<p><span class="text-muted">Barcode:</span> <span class="text-bold-700" id="barcode"><?=$document['barcode']?></span></p>
										<p><span class="text-muted">Document Type: </span><span class="text-bold-700"><?=$document['doc_type']['document_type']?></span></p>
										<p><span class="text-muted">Originating Office: </span><span class="text-bold-700"><?=($document['other_origin']==null)?$document['origin']['office']:$document['other_origin']?></span></p>
										<p><span class="text-muted">Subject: </span><span class="text-bold-700"><?=$document['doc_name']?></span></p>							
									</div>
									<div class="col-md-6 col-sm-12 text-xs-center text-md-left">
										<p><span class="text-muted">Communication: </span><span class="text-bold-700"><?=$document['communication']['communication']?></span></p>
										<p><span class="text-muted">Transaction: </span><span class="text-bold-700"><?=$document['document_transaction_type']['transaction']?> (<?=$document['document_transaction_type']['days']?> working days)</span></p>
										<p><span class="text-muted">Date:</span> <span class="text-bold-700"><?=$document['document_date']?></span></p>
										<p><span class="text-muted">Due Date:</span> <span class="text-bold-700"><?=$document['due_date']?></p>							
									</div>
								</div>
								<div class="row">
									<div class="col-md-12 col-sm-12 text-xs-center text-md-left">
										<p><span class="text-muted">Remarks: </span><span class="text-bold-700"><?=$document['remarks']?></span></p>
									</div>
								</div>
								<div class="row">
									<div class="col-lg-12">
										<hr>
										<div class="form-group">
											<label>Files:</label>
											<div class="images-container">
												<div class="image-container" ng-repeat="df in documentFiles">
													<div class="controls">
														<a href="javascript:;" class="control-btn" ng-click="app.previewThumbnail(this,df,'../dialogs/preview.html')">
															<i class="icon-search7"></i>
														</a>																
														<a href="javascript:;" class="control-btn" action-remove-file="{{$index}}">
															<i class="icon-trash4"></i>
														</a>														
													</div>
													<object id="dfpdf{{$index}}" class="object" data="" ng-show="df.type == 'pdf'"></object>
													<img id="dfimg{{$index}}" class="image" src="" ng-show="df.type == 'jpeg' || df.type == 'png'">
												</div>
												<input type="file" style="display: none;" id="upload-files" action-upload-files>
												<a href="javascript:;" class="add-image" ng-click="app.addFile(this)">
													<div class="image-container new">
														<div class="image">
															<i class="icon-plus4"></i>
														</div>
													</div>
												</a>												
											</div>
										</div>
									</div>
								</div>
							</div>
						</div>
					</section>
					<section class="card">
						<div class="card-header">
							<h4 class="card-title" id="basic-layout-form">Revisions</h4>
							<a class="heading-elements-toggle"><i class="icon-ellipsis font-medium-3"></i></a>
							<div class="heading-elements">
								<ul class="list-inline mb-0">
									<li><a href="javascript:;" ng-click="app.revisions.revision(this,null)"><i class="icon-plus"></i></a></li>
								</ul>
							</div>							
						</div>	
						<div class="card-body collapse in" aria-expanded="true">
							<div class="card-block">
								<div class="row">
									<div class="col-lg-6 offset-lg-6">
										<div class="form-group">
											<div class="has-icon-left">
												<input type="text" class="form-control" ng-model="views.search">
												<div class="form-control-position">
													<i class="icon-search5"></i>
												</div>
											</div>
										</div>
										<div class="clearfix"></div>
									</div>						
								</div>								
								<table class="table table-revisions">
									<thead>
										<tr><th>#</th><th>Date Added</th><th>Notes</th><th>Status</th><th>Date Completed</th><th>Update</th><th>Manage</th></tr>
									</thead>
									<tbody>
										<tr ng-repeat="r in revisions | filter:views.search">
											<td>{{$index+1}}</td>
											<td>{{r.datetime}}</td>
											<td>{{r.notes}}</td>
											<td>{{(r.revision_ok)?'Ok':''}}</td>
											<td>{{r.datetime_completed}}</td>											
											<td>
												<div class="checkbox">
													<label class="switch-sm">
													  <input type="checkbox" hidden="hidden" ng-model="r.revision_ok" ng-checked="r.revision_ok" ng-click="app.revisions.update(this,r)">
													  <span class="slider-sm round"></span>
													</label>
												</div>
											</td>
											<td>
												<a href="javascript:;" style="margin-right: 5px; color: #373a3c!important;" ng-click="app.revisions.revision(this,r)"><i class="icon-edit"></i></a>
												<a href="javascript:;" style="color: #373a3c!important;" ng-click="app.revisions.delete(this,r)"><i class="icon-remove"></i></a>
											</td>											
										</tr>
									</tbody>
								</table>
							</div>
						</div>
					</section>
				</div>
				<div class="col-lg-4">
					<div class="card" ng-repeat="action in doc.actions">
						<div id="headingCollapse{{$index}}" class="card-header">
							<a href="javascript:;" aria-expanded="true" aria-controls="for_action{{$index}}" class="card-title lead">{{action.track_action_description}}</a>
						</div>
						<div id="for_action{{$index}}" role="tabpanel" aria-labelledby="headingCollapse{{$index}}" class="card-collapse collapse in" aria-expanded="true" style="">
							<div class="card-body">
								<div class="card-block">
									<div ng-repeat="staff in action.staffs">
										<div class="checkbox">
											<label class="switch">
											  <input type="checkbox" hidden="hidden" ng-model="staff.done" ng-checked="staff.done" ng-change="app.action(this,action,staff)">
											  <span class="slider round"></span>
											</label>
											<p style="margin-left: 65px; margin-top: -35px!important;">{{staff.description}}</p>
										</div>							
									</div>
								</div>
							</div>
						</div>
					</div>
					<div class="card">
						<div id="headingCollapse" class="card-header">
							<a href="javascript:;" aria-expanded="true" aria-controls="comment" class="card-title lead">Comment</a>
						</div>
						<div id="comment" role="tabpanel" aria-labelledby="headingCollapse" class="card-collapse collapse in" aria-expanded="true" style="">
							<div class="card-body">
								<div class="card-block">
									<button type="button" class="btn btn-primary" ng-click="app.comment(this)">Add</button>
								</div>
							</div>
						</div>
					</div>					
					<div class="card">
						<div id="headingCollapse" class="card-header">
							<a href="javascript:;" aria-expanded="true" aria-controls="transit" class="card-title lead">Pick up</a>
						</div>
						<div id="transit" role="tabpanel" aria-labelledby="headingCollapse" class="card-collapse collapse in" aria-expanded="true" style="">
							<div class="card-body">
								<div class="card-block">
									<form class="form" name="formHolder.transit">
										<div class="form-body">
											<div class="row">
												<div class="col-md-12">
													<div class="form-group">
														<label>Office</label>
														<select class="form-control" name="office" ng-model="transit.office" ng-options="office.office for office in offices track by office.office" ng-change="staffs.transit = transit.office.staffs" required></select>
													</div>
												</div>												
												<div class="col-md-12">
													<div class="form-group">
														<label>Staff</label>
														<select class="form-control" name="staff" ng-model="transit.staff" ng-options="staff.fullname for staff in staffs.transit track by staff.id" required></select>
													</div>
												</div>											
											</div>
										</div>
										<div class="form-actions">
											<button type="button" class="btn btn-primary float-lg-right float-xs-right" ng-click="app.transit(this)">Ok</button>
										</div>
									</form>
								</div>
							</div>
						</div>
					</div>
					<div class="card">
						<div id="headingCollapse" class="card-header">
							<a href="javascript:;" aria-expanded="true" aria-controls="release" class="card-title lead">Release</a>
						</div>
						<div id="release" role="tabpanel" aria-labelledby="headingCollapse" class="card-collapse collapse in" aria-expanded="true" style="">
							<div class="card-body">
								<div class="card-block">
									<form class="form" name="formHolder.release">
										<div class="form-body">
											<div class="row">
												<div class="col-md-12">
													<div class="form-group">
														<label>Office</label>
														<select class="form-control" name="office" ng-model="release.office" ng-options="office.office for office in offices track by office.office" ng-change="staffs.release = release.office.staffs" required></select>
													</div>
												</div>												
												<div class="col-md-12">
													<div class="form-group">
														<label>Staff</label>
														<select class="form-control" name="staff" ng-model="release.staff" ng-options="staff.fullname for staff in staffs.release track by staff.id" required></select>
													</div>
												</div>											
											</div>
										</div>
										<div class="form-actions">
											<button type="button" class="btn btn-primary float-lg-right float-xs-right" ng-click="app.release(this)">Ok</button>
										</div>
									</form>
								</div>
							</div>
						</div>
					</div>					
				</div>
			</div>
		</div>
	  </div>
    </div>
    <!-- ////////////////////////////////////////////////////////////////////////////-->


    <footer class="footer footer-static footer-light navbar-border">
      <p class="clearfix text-muted text-sm-center mb-0 px-2"><span class="float-md-left d-xs-block d-md-inline-block">Copyright &copy; <b><?php echo date("Y"); ?></b> Document Tracking System. All rights reserved. </span></p>
    </footer>

    <!-- BEGIN VENDOR JS-->
    <script src="<?=$url?>app-assets/js/core/libraries/jquery.min.js" type="text/javascript"></script>
    <script src="<?=$url?>app-assets/vendors/js/ui/tether.min.js" type="text/javascript"></script>
    <script src="<?=$url?>app-assets/js/core/libraries/bootstrap.min.js" type="text/javascript"></script>
    <script src="<?=$url?>app-assets/vendors/js/ui/perfect-scrollbar.jquery.min.js" type="text/javascript"></script>
    <script src="<?=$url?>app-assets/vendors/js/ui/unison.min.js" type="text/javascript"></script>
    <script src="<?=$url?>app-assets/vendors/js/ui/blockUI.min.js" type="text/javascript"></script>
    <script src="<?=$url?>app-assets/vendors/js/ui/jquery.matchHeight-min.js" type="text/javascript"></script>
    <script src="<?=$url?>app-assets/vendors/js/ui/screenfull.min.js" type="text/javascript"></script>
    <script src="<?=$url?>app-assets/vendors/js/extensions/pace.min.js" type="text/javascript"></script>
    <!-- BEGIN VENDOR JS-->
    <!-- BEGIN PAGE VENDOR JS-->
    <script src="<?=$url?>app-assets/vendors/js/charts/chart.min.js" type="text/javascript"></script>
    <!-- END PAGE VENDOR JS-->
    <!-- BEGIN ROBUST JS-->
    <script src="<?=$url?>app-assets/js/core/app-menu.js" type="text/javascript"></script>
    <script src="<?=$url?>app-assets/js/core/app.js" type="text/javascript"></script>
    <!-- END ROBUST JS-->
	
    <script src="<?=$url?>app-assets/js/jquery-barcode-scanner/jquery.scannerdetection.js" type="text/javascript"></script>	
	
	<!-- jspdf -->
	<script src="<?=$url?>app-assets/js/jspdf/jspdf.min.js"></script>
	<script src="<?=$url?>app-assets/js/jspdf/jspdf.plugin.autotable.js"></script>
	
	<link rel="stylesheet" href="<?=$url?>angular/modules/bootbox/bs4-fix.css">	
	<script src="<?=$url?>angular/modules/bootbox/bootbox.min.js"></script>
	<script src="<?=$url?>angular/modules/growl/jquery.bootstrap-growl.min.js"></script>
	<script src="<?=$url?>angular/modules/blockui/jquery.blockUI.js"></script>
	<link rel="stylesheet" href="<?=$url?>angular/modules/bootbox/bs4-fix.css">
	
	<!-- dependencies -->
	<script src="<?=$url?>angular/angular.min.js"></script>
	<script src="<?=$url?>angular/angular-route.min.js"></script>
	<script src="<?=$url?>angular/angular-sanitize.min.js"></script>
	<script src="<?=$url?>angular/ui-bootstrap-tpls-3.0.2.min.js"></script>
	
	<script src="<?=$url?>angular/modules/account/account-document-view.js"></script>
	
	<script src="<?=$url?>angular/modules/bootbox/bootstrap-modal.js"></script>
	<script src="<?=$url?>angular/modules/growl/growl.js"></script>
	<script src="<?=$url?>angular/modules/blockui/blockui.js"></script>
	<script src="<?=$url?>angular/modules/validation/validate.js"></script>
	<script src="<?=$url?>angular/modules/validation/validate-dialog.js"></script>
	<script src="<?=$url?>angular/modules/post/window-open-post.js"></script>
	
	<!-- modules -->
	<script src="/modules/notifications.js"></script>
	<script src="<?=$url?>modules/module-access.js"></script>
	<script src="<?=$url?>modules/jspdf.js"></script>
	<script src="<?=$url?>modules/upload-files.js"></script>

	<script src="../modules/url.js"></script>
	<script src="../modules/files.js"></script>
	<script src="../modules/barcode-listener-action.js"></script>
	<script src="../modules/action.js"></script>
	
	<!-- controller -->
	<script src="../controllers/action.js"></script>
  </body>
</html>
